<!-- templates/terminal.html -->
<!DOCTYPE html>
<html>

<head>
    <title>Terminal Emulator</title>
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: monospace;
            margin: 0;
            padding: 0;
        }

        #terminal {
            width: 80%;
            margin: 0 auto;
            padding: 10px;
            border: 1px solid #ccc;
            background-color: #000;
            white-space: pre;
            font-family: monospace;
            overflow: auto;
            height: 70vh;
        }

        #command-form {
            display: flex;
            align-items: center;
        }

        #command-input {
            flex: 1;
            background-color: #000;
            border: none;
            color: #fff;
            font-family: monospace;
            font-size: 16px;
            padding: 10px;
        }

        #command-input:focus {
            outline: none;
        }

        #execute-button {
            background-color: #00ff00;
            border: none;
            color: #000;
            font-family: monospace;
            font-size: 16px;
            padding: 10px;
            cursor: pointer;
        }

        #execute-button:hover {
            background-color: #00cc00;
        }
    </style>
</head>
<body>
    <h1>Terminal Emulator</h1>
    <div id="terminal"></div>
    <form id="command-form">
        <input type="text" id="command-input" placeholder="Enter a command" autofocus>
        <button type="submit" id="execute-button">Execute</button>
    </form>

    <script>
        const terminal = document.getElementById('terminal');
        const commandForm = document.getElementById('command-form');
        const commandInput = document.getElementById('command-input');
        const executeButton = document.getElementById('execute-button');

        commandForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const input = commandInput.value;
            sendCommand(input);
            commandInput.value = '';
            terminal.textContent += `$ ${input}\n`;
        });

        function sendCommand(command) {
            fetch('/send_command', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ command: command }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    getOutput();
                }
            });
        }

        function getOutput() {
            fetch('/get_output')
            .then(response => response.json())
            .then(data => {
                data.outputs.forEach(output => {
                    terminal.textContent += `${output}\n`;
                });
                terminal.scrollTop = terminal.scrollHeight;
            });
        }

        setInterval(getOutput, 1000); // Polling every 1 second to get new output
    </script>
</body>
</html>

